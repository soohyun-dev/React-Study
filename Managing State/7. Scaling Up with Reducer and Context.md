## Scaling Up with Reducer and Context

### ğŸ“Œ í•™ìŠµ ëª©í‘œ

- reducerì™€ Contextë¥¼ ê²°í•©í•˜ëŠ” ë°©ë²•
- stateì™€ dispatch í•¨ìˆ˜ë¥¼ propìœ¼ë¡œ ì „ë‹¬í•˜ì§€ ì•ŠëŠ” ë°©ë²•
- contextì™€ state ë¡œì§ì„ ë³„ë„ì˜ íŒŒì¼ì—ì„œ ê´€ë¦¬í•˜ëŠ” ë°©ë²•

---

## Reducerì™€ contextë¥¼ ê²°í•©í•˜ê¸°

- reducerëŠ” ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ì§§ê³  ê°„ê²°í•˜ê²Œ ìœ ì§€í•˜ëŠ”ë° ë„ì›€ì„ ì¤ë‹ˆë‹¤. í•˜ì§€ë§Œ, í”„ë¡œì íŠ¸ê°€ ì»¤ì§€ê²Œë˜ë©´ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ê°€ ì‘ì—… ëª©ë¡ì„ ì½ê±°ë‚˜ ë³€ê²½í•˜ë„ë¡ í•˜ê¸° ìœ„í•´ í˜„ì¬ stateì™€ ì´ë¥¼ ë³€ê²½í•˜ëŠ” ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ propsë¡œ ëª…ì‹œì ìœ¼ë¡œ ì „ë‹¬í•´ì•¼ í•˜ëŠ” ì–´ë ¤ì›€ì´ ìƒê¹ë‹ˆë‹¤.

- ì´ë•Œ, stateì™€ dispatch í•¨ìˆ˜ë¥¼ contextì—ë„£ì–´ì„œ 'props drilling' ì—†ì´ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Reducerì™€ contextë¥¼ ê²°í•©í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

1. Contextë¥¼ ìƒì„±í•œë‹¤.
2. Stateì™€ dispatch í•¨ìˆ˜ë¥¼ contextì— ë„£ëŠ”ë‹¤.
3. íŠ¸ë¦¬ ì•ˆì—ì„œ contextë¥¼ ì‚¬ìš©í•œë‹¤.
   <br>

### 1. Context ìƒì„±

```javascript
import { createContext } from "react";

export const TasksContext = createContext(null);
export const TasksDispatchContext = createContext(null);
```

íŠ¸ë¦¬ë¥¼ í†µí•´ ì „ë‹¬í•˜ë ¤ë©´, ë‘ ê°œì˜ ë³„ê°œì˜ contextë¥¼ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤.

- `TasksContext`ëŠ” í˜„ì¬ tasks ë¦¬ìŠ¤íŠ¸ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
- `TasksDispatchContext`ëŠ” ì»´í¬ë„ŒíŠ¸ì—ì„œ actionì„ dispatch í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

<br>

### 2. Stateê³¼ dispatch í•¨ìˆ˜ë¥¼ contextì— ë„£ê¸°

```javascript
import { TasksContext, TasksDispatchContext } from "./TasksContext.js";

export default function TaskApp() {
  const [tasks, dispatch] = useReducer(tasksReducer, initialTasks);
  // ...
  return (
    <TasksContext.Provider value={tasks}>
      <TasksDispatchContext.Provider value={dispatch}>
        ...
      </TasksDispatchContext.Provider>
    </TasksContext.Provider>
  );
}
```

- ì´ì œ TaskApp ì»´í¬ë„ŒíŠ¸ì—ì„œ ë‘ Contextë¥¼ ëª¨ë‘ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br>

### 3. íŠ¸ë¦¬ ì•ˆì—ì„œ context ì‚¬ìš©í•˜ê¸°

```javascript
<TasksContext.Provider value={tasks}>
  <TasksDispatchContext.Provider value={dispatch}>
    <h1>Day off in Kyoto</h1>
    <AddTask />
    <TaskList />
  </TasksDispatchContext.Provider>
</TasksContext.Provider>
```

```javascript
export default function TaskList() {
  const tasks = useContext(TasksContext);
  // ...
}


export default function AddTask({ onAddTask }) {
  const [text, setText] = useState('');
  const dispatch = useContext(TasksDispatchContext);
  // ...
  return
  // ...
}
```

- ì´ì œ tasksë‚˜ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ íŠ¸ë¦¬ ì•„ë˜ë¡œ ì „ë‹¬í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.
- í•„ìš”í•œ ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” `TasksContext`ì—ì„œ taskë¥¼ `TasksDispatchContext`ì—ì„œ dispatchë¥¼ ì½ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- stateëŠ” ì—¬ì „íˆ useReducerë¡œ ê´€ë¦¬ë˜ëŠ” ìµœìƒìœ„ ì»´í¬ë„ŒíŠ¸ì— ì¡´ì¬í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ, íŠ¸ë¦¬ ì•„ë˜ì˜ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ì—ì„œ ì´ëŸ¬í•œ contextë¥¼ ê°€ì ¸ì˜¤ê³  ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br>

### í•˜ë‚˜ì˜ íŒŒì¼ë¡œ í•©ì¹˜ê¸°

```javascript
import { createContext, useContext, useReducer } from "react";

const TasksContext = createContext(null);

const TasksDispatchContext = createContext(null);

export function TasksProvider({ children }) {
  const [tasks, dispatch] = useReducer(tasksReducer, initialTasks);

  return (
    <TasksContext.Provider value={tasks}>
      <TasksDispatchContext.Provider value={dispatch}>
        {children}
      </TasksDispatchContext.Provider>
    </TasksContext.Provider>
  );
}

export function useTasks() {
  return useContext(TasksContext);
}

export function useTasksDispatch() {
  return useContext(TasksDispatchContext);
}

function tasksReducer(tasks, action) {
  switch (action.type) {
    case "added": {
      return [
        ...tasks,
        {
          id: action.id,
          text: action.text,
          done: false,
        },
      ];
    }
    case "changed": {
      return tasks.map((t) => {
        if (t.id === action.task.id) {
          return action.task;
        } else {
          return t;
        }
      });
    }
    case "deleted": {
      return tasks.filter((t) => t.id !== action.id);
    }
    default: {
      throw Error("Unknown action: " + action.type);
    }
  }
}

const initialTasks = [
  { id: 0, text: "Philosopherâ€™s Path", done: true },
  { id: 1, text: "Visit the temple", done: false },
  { id: 2, text: "Drink matcha", done: false },
];
```

- ì´ë ‡ê²Œ ëª¨ë“  contextì™€ reducerë¥¼ í•˜ë‚˜ì˜ íŒŒì¼ë¡œ ëª¨ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì»´í¬ë„ŒíŠ¸ë“¤ì´ ë°ì´í„°ë¥¼ ì–´ë””ì„œ ê°€ì ¸ì˜¤ëŠ”ì§€ê°€ ì•„ë‹Œ ë¬´ì—‡ì„ ë³´ì—¬ì¤„ ê²ƒì¸ì§€ì— ì§‘ì¤‘í•  ìˆ˜ ìˆë„ë¡ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.
- ì•±ì´ ì»¤ì§ˆìˆ˜ë¡ ì´ì™€ ê°™ì€ context-reducer ì¡°í•©ì´ ë” ë§ì•„ì§ˆ ê²ƒì…ë‹ˆë‹¤.

<br>

## ğŸ‘¨â€ğŸ’» ì •ë¦¬

- Reducerì™€ contextë¥¼ ê²°í•©í•´ì„œ ì»´í¬ë„ŒíŠ¸ê°€ ìƒìœ„ stateë¥¼ ì½ê³  ìˆ˜ì •í•  ìˆ˜ ìˆë„ë¡ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
