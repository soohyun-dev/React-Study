## Extracting State Logic into a Reducer

### ğŸ“Œ í•™ìŠµ ëª©í‘œ

- reducer í•¨ìˆ˜ë€ ë¬´ì—‡ì¸ê°€
- useStateì—ì„œ useReducerë¡œ ë¦¬íŒ©í„°ë§ í•˜ëŠ” ë°©ë²•
- reducerë¥¼ ì–¸ì œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ì§€
- reducerë¥¼ ì˜ ì“°ëŠ” ë°©ë²•

---

## reducerë¥¼ ì‚¬ìš©í•˜ì—¬ state ë¡œì§ í†µí•©í•˜ê¸°

- ë³µì¡ì„±ì„ ì¤„ì´ê³  ì ‘ê·¼ì„±ì„ ë†’ì´ê¸° ìœ„í•´ì„œ, ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì— ìˆëŠ” state ë¡œì§ì„ ì»´í¬ë„ŒíŠ¸ ì™¸ë¶€ì˜ "reducer"ë¼ê³  í•˜ëŠ” ë‹¨ì¼ í•¨ìˆ˜ë¡œ ì˜®ê¸¸ ìˆ˜ ìˆë‹¤.

1. stateë¥¼ ì„¤ì •í•˜ëŠ” ê²ƒì—ì„œ actionì„ dispatch í•¨ìˆ˜ë¡œ ì „ë‹¬í•˜ëŠ” ê²ƒìœ¼ë¡œ ë°”ê¾¸ê¸°
2. reducer í•¨ìˆ˜ ì‘ì„±í•˜ê¸°
3. ì»´í¬ë„ŒíŠ¸ì—ì„œ reducer ì‚¬ìš©í•˜ê¸°

<br>

### 1. stateë¥¼ ì„¤ì •í•˜ëŠ” ê²ƒì—ì„œ actionì„ dispatch í•¨ìˆ˜ë¡œ ì „ë‹¬í•˜ëŠ” ê²ƒìœ¼ë¡œ ë°”ê¾¸ê¸°

```javascript
function handleAddTask(text) {
  setTasks([
    ...tasks,
    {
      id: nextId++,
      text: text,
      done: false,
    },
  ]);
}

function handleChangeTask(task) {
  setTasks(
    tasks.map((t) => {
      if (t.id === task.id) {
        return task;
      } else {
        return t;
      }
    })
  );
}

function handleDeleteTask(taskId) {
  setTasks(tasks.filter((t) => t.id !== taskId));
}
```

```javascript
function handleAddTask(text) {
  dispatch({
    // "action" ê°ì²´
    type: "added",
    id: nextId++,
    text: text,
  });
}

function handleChangeTask(task) {
  dispatch({
    type: "changed",
    task: task,
  });
}

function handleDeleteTask(taskId) {
  dispatch({
    type: "deleted",
    id: taskId,
  });
}
```

<br>

- ì•¡ì…˜ ê°ì²´ëŠ” ì–´ë–¤ ê²ƒì´ë“  ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```javascript
dispatch({
  // ì»´í¬ë„ŒíŠ¸ë§ˆë‹¤ ë‹¤ë¥¸ ê°’
  type: "what_happened",
  // ë‹¤ë¥¸ í•„ë“œëŠ” ì´ê³³ì—
});
```

- ì–´ë–¤ ìƒí™©ì´ ë°œìƒí•  ê²ƒì¸ì§€ì— ëŒ€í•œ ë¬¸ìì—´ íƒ€ì…ì„ ë„˜ê²¨ì£¼ê³  ì´ì™¸ì˜ ì •ë³´ëŠ” ë‹¤ë¥¸ í•„ë“œì— ë‹´ì•„ì„œ ì „ë‹¬í•˜ë„ë¡ ì‘ì„±í•©ë‹ˆë‹¤.

<br>

### 2. reducer í•¨ìˆ˜ ì‘ì„±í•˜ê¸°

```javascript
function yourReducer(state, action) {
  // Reactê°€ ì„¤ì •í•˜ê²Œë  ë‹¤ìŒ state ê°’ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
}
```

- reducer í•¨ìˆ˜ëŠ” stateì— ëŒ€í•œ ë¡œì§ì„ ë„£ëŠ” ê³³ì´ë‹¤.
- í˜„ì¬ì˜ state ê°’ê³¼ action ê°ì²´ ë‘ê°œì˜ ì¸ìë¥¼ ë°›ê³  ë‹¤ìŒ state ê°’ì„ ë°˜í™˜í•œë‹¤.

```javascript
function tasksReducer(tasks, action) {
  if (action.type === "added") {
    return [
      ...tasks,
      {
        id: action.id,
        text: action.text,
        done: false,
      },
    ];
  } else if (action.type === "changed") {
    return tasks.map((t) => {
      if (t.id === action.task.id) {
        return action.task;
      } else {
        return t;
      }
    });
  } else if (action.type === "deleted") {
    return tasks.filter((t) => t.id !== action.id);
  } else {
    throw Error("Unknown action: " + action.type);
  }
}
```

- switch ë¬¸ìœ¼ë¡œ ì‘ì„±í•˜ëŠ” ê²ƒì´ ê°€ë…ì„±ì— ë” ì¢‹ë‹¤.

```javascript
function tasksReducer(tasks, action) {
  switch (action.type) {
    case "added": {
      return [
        ...tasks,
        {
          id: action.id,
          text: action.text,
          done: false,
        },
      ];
    }
    case "changed": {
      return tasks.map((t) => {
        if (t.id === action.task.id) {
          return action.task;
        } else {
          return t;
        }
      });
    }
    case "deleted": {
      return tasks.filter((t) => t.id !== action.id);
    }
    default: {
      throw Error("Unknown action: " + action.type);
    }
  }
}
```

<br>

### 3. ì»´í¬ë„ŒíŠ¸ì—ì„œ reducer ì‚¬ìš©í•˜ê¸°

```javascript
import { useReducer } from "react";

// const [tasks, setTasks] = useState(initialTasks);
const [tasks, dispatch] = useReducer(tasksReducer, initialTasks);
```

- useReducer Hookì€ ë‘ ê°œì˜ ì¸ìë¥¼ ë„˜ê²¨ ë°›ëŠ”ë‹¤.

1. reducer í•¨ìˆ˜
2. ì´ˆê¸° state ê°’

- ë°˜í™˜ê°’ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

1. stateë¥¼ ë‹´ì„ ìˆ˜ ìˆëŠ” ê°’
2. dispatch í•¨ìˆ˜ (ì‚¬ìš©ìì˜ actionì„ reducer í•¨ìˆ˜ì—ê²Œ "ì „ë‹¬í•˜ê²Œ ë ")

```javascript
import { useReducer } from "react";
import AddTask from "./AddTask.js";
import TaskList from "./TaskList.js";

export default function TaskApp() {
  const [tasks, dispatch] = useReducer(tasksReducer, initialTasks);

  function handleAddTask(text) {
    dispatch({
      type: "added",
      id: nextId++,
      text: text,
    });
  }

  function handleChangeTask(task) {
    dispatch({
      type: "changed",
      task: task,
    });
  }

  function handleDeleteTask(taskId) {
    dispatch({
      type: "deleted",
      id: taskId,
    });
  }

  return (
    <>
      <h1>Prague itinerary</h1>
      <AddTask onAddTask={handleAddTask} />
      <TaskList
        tasks={tasks}
        onChangeTask={handleChangeTask}
        onDeleteTask={handleDeleteTask}
      />
    </>
  );
}

function tasksReducer(tasks, action) {
  switch (action.type) {
    case "added": {
      return [
        ...tasks,
        {
          id: action.id,
          text: action.text,
          done: false,
        },
      ];
    }
    case "changed": {
      return tasks.map((t) => {
        if (t.id === action.task.id) {
          return action.task;
        } else {
          return t;
        }
      });
    }
    case "deleted": {
      return tasks.filter((t) => t.id !== action.id);
    }
    default: {
      throw Error("Unknown action: " + action.type);
    }
  }
}

let nextId = 3;
const initialTasks = [
  { id: 0, text: "Visit Kafka Museum", done: true },
  { id: 1, text: "Watch a puppet show", done: false },
  { id: 2, text: "Lennon Wall pic", done: false },
];
```

- ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ëŠ” actionì„ ì „ë‹¬í•´ì¤˜ì„œ ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚¬ëŠ”ì§€ì— ê´€ë ¨í•´ì„œë§Œ ëª…ì‹œí•˜ë©´ ë˜ê³  reducer í•¨ìˆ˜ëŠ” ì´ì— ëŒ€í•œ ì‘ë‹µìœ¼ë¡œ stateê°€ ì–´ë–¤ ê°’ìœ¼ë¡œ ì—…ë°ì´íŠ¸ ë ì§€ë¥¼ ê²°ì •í•˜ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.

<br>

### useStateì™€ useReducer ë¹„êµí•˜ê¸°

reducerê°€ ì¢‹ì€ ì ë§Œ ìˆëŠ” ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤.

- ì½”ë“œ sizeê°€ useStateë³´ë‹¤ ë§ì•„ì§‘ë‹ˆë‹¤.
- useStateë³´ë‹¤ ê°€ë…ì„±ì´ ë–¨ì–´ì§‘ë‹ˆë‹¤.
- ë””ë²„ê¹…ì„ í•  ì‹œ useStateë³´ë‹¤ ë” ë§ì€ ì½”ë“œë¥¼ ë‹¨ê³„ë³„ë¡œ ì‹¤í–‰í•´ì„œ ë””ë²„ê¹…ì„ í•´ì•¼í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ, í•´ë‹¹ ë²„ê·¸ê°€ ì™œ ë°œìƒí•˜ëŠ” ì§€ì— ëŒ€í•´ì„œëŠ” useStateë³´ë‹¤ ëª…í™•íˆ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br>

- ë§Œì•½ ì¼ë¶€ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì˜ëª»ëœ ë°©ì‹ìœ¼ë¡œ stateë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ê²ƒìœ¼ë¡œ ì¸í•œ ë²„ê·¸ê°€ ìì£¼ ë°œìƒí•˜ê±°ë‚˜ í•´ë‹¹ ì½”ë“œì— ë” ë§ì€ êµ¬ì¡°ë¥¼ ë„ì…í•˜ê³  ì‹¶ë‹¤ë©´ reducer ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤.

<br>

### reducer ì˜ ì‘ì„±í•˜ê¸°

1. reducerëŠ” ìˆœìˆ˜í•´ì•¼í•©ë‹ˆë‹¤. ë™ì¼í•œ ì…ë ¥ì€ í•­ìƒ ë™ì¼í•œ ì¶œë ¥ì„ ìƒì„±í•´ì•¼í•©ë‹ˆë‹¤. ì»´í¬ë„ŒíŠ¸ ì™¸ë¶€ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ì‘ì—…ì„ ìˆ˜í–‰í•´ì„œëŠ” ì•ˆë˜ë©°, ë³€í˜• ì—†ì´ ê°œì²´ì™€ ë°°ì—´ì„ ì—…ë°ì´íŠ¸í•´ì•¼ í•©ë‹ˆë‹¤.
2. ëª¨ë“  ì‘ì—…ì„ ê¸°ë¡í•˜ëŠ” ê²½ìš° reducerëŠ” ì–´ë–¤ ìƒí˜¸ì‘ìš©, ì–´ë–¤ ì‘ë‹µì´ ì–´ë–¤ ìˆœì„œë¡œ ë°œìƒí–ˆëŠ”ì§€ ì¬êµ¬ì„±í•  ìˆ˜ ìˆì„ë§Œí¼ ëª…í™•í•´ì•¼ í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ í• ìˆ˜ë¡ ë””ë²„ê¹…ì— ë„ì›€ì´ ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

<br>

## ğŸ‘¨â€ğŸ’» ì •ë¦¬

- reducerëŠ” ë” ë§ì€ ì½”ë“œë¥¼ ìš”êµ¬í•˜ì§€ë§Œ ë””ë²„ê¹…ê³¼ í…ŒìŠ¤íŠ¸ì— ìš©ì´í•©ë‹ˆë‹¤.
- reducerëŠ” ìˆœìˆ˜í•´ì•¼í•©ë‹ˆë‹¤.
- ê° actionì€ ë‹¨ì¼ ìƒí˜¸ì‘ìš©ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
- mutating styleë¡œ reducerë¥¼ ì‘ì„±í•˜ë ¤ë©´ Immerë¥¼ ì‚¬ìš©í•˜ì‹­ì‹œì˜¤.
